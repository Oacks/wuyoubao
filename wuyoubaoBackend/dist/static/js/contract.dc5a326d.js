(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["contract"],{"07bf":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"goods-form"},[a("h2",[t._v("合同管理")]),a("hr",{staticStyle:{"margin-bottom":"10px"}}),a("div",{staticClass:"table-area"},[a("div",{staticStyle:{margin:"10px 0"}},[a("el-form",{staticClass:"demo-form-inline",attrs:{model:t.searchForm,"label-width":"120px"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"合同状态"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},t._l(t.statusOpt,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"会员姓名"}},[a("el-input",{model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)],1),a("div",[a("el-button",{staticStyle:{"margin-left":"40px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.search}},[t._v("搜索")])],1)],1)],1)],1),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:t.tableData,border:"","row-key":"id","header-cell-class-name":"table-header"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{prop:"memberName",label:"客户名"}}),a("el-table-column",{attrs:{prop:"status",label:"合同状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(t.getStatus(e.row.status))+"\n                ")]}}])}),a("el-table-column",{attrs:{prop:"status",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"white-space":"nowrap"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.detail(e.row)}}},[t._v("查看详情")]),"1"==e.row.status?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.exportContract(e.row)}}},[t._v("下载合同")]):t._e(),"1"==e.row.status?a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){return t.approvalReady(e.row)}}},[t._v("审批")]):t._e(),"1"==e.row.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.reback(e.row)}}},[t._v("不同意")]):t._e(),"3"==e.row.status||"4"==e.row.status?a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){return t.showContract(e.row)}}},[t._v("查看合同")]):t._e()],1)]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":t.page.no,"page-size":t.page.size,total:t.page.total},on:{"current-change":t.handlePageChange}})],1),a("el-dialog",{staticClass:"user-dialog",attrs:{"close-on-click-modal":!1,title:"detail"===t.operate?"查看合同":"",visible:t.dialogVisible,"before-close":t.closeDialog,width:"900px"}},[a("el-form",{staticClass:"demo-form-inline",attrs:{model:t.detailInfo,"label-width":"140px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"合同号："}},[t._v("\n                                "+t._s(t.detailInfo.contractNo)+"\n                            ")])],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"车主姓名："}},[t._v("\n                                "+t._s(t.detailInfo.memberName)+"\n                            ")])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"联系电话："}},[t._v("\n                                "+t._s(t.detailInfo.mobile)+"\n                            ")])],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"联系地址："}},[t._v("\n                                "+t._s(t.detailInfo.address)+"\n                            ")])],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"车辆品牌："}},[t._v("\n                                "+t._s(t.detailInfo.brand)+"\n                            ")])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"车辆型号："}},[t._v("\n                                "+t._s(t.detailInfo.vehicle)+"\n                            ")])],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"车辆购买时间："}},[t._v("\n                                "+t._s(t.detailInfo.carBuyTime)+"\n                            ")])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"车辆类型："}},[t._v("\n                                "+t._s("0"==t.detailInfo.carType?"新车":"1"==t.detailInfo.carType?"旧车":"")+"\n                            ")])],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"原厂保修起始日期："}},[t._v("\n                                "+t._s(t.detailInfo.oldStartTime)+"\n                            ")])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"原厂保修结束日期："}},[t._v("\n                                "+t._s(t.detailInfo.oldEndTime)+"\n                            ")])],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"车架号（VIN）："}},[t._v("\n                                "+t._s(t.detailInfo.vin)+"\n                            ")])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"发动机号："}},[t._v("\n                                "+t._s(t.detailInfo.engineNum)+"\n                            ")])],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"车牌号码："}},[t._v("\n                                "+t._s(t.detailInfo.licensePlate)+"\n                            ")])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"车辆售出价格："}},[t._v("\n                                "+t._s(t.detailInfo.carPrice)+"\n                            ")])],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"延保销售日期"}},[t._v("\n                                "+t._s(t.detailInfo.createTime)+"\n                            ")])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"延保卡券："}},[t._v("\n                                "+t._s(t.detailInfo.projectId)+"\n                            ")])],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"延保起期："}},[t._v("\n                                "+t._s(t.detailInfo.startTime)+"\n                            ")])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"行驶里程："}},[t._v("\n                                "+t._s(t.detailInfo.mileage)+"\n                            ")])],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:4!=t.detailInfo.status?"邮品：":"邮品卡号："}},[4!=t.detailInfo.status?a("div",t._l(t.detailInfo.accessoriesList,(function(e,s){return a("div",{key:s},[t._v(t._s(e.title))])})),0):t._e(),4==t.detailInfo.status?a("div",t._l(t.detailInfo.saleList,(function(e,s){return 1==e.saleType?a("div",{key:s},[t._v(t._s(e.title))]):t._e()})),0):t._e()])],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"合同图片："}},[a("div",{staticClass:"pic-list"},[a("el-image",{staticClass:"pic-list-item-img",attrs:{src:t.detailInfo.pic,"preview-src-list":[t.detailInfo.pic]}})],1)])],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("确 定")])],1)],1),a("el-dialog",{staticClass:"user-dialog",attrs:{"close-on-click-modal":!1,title:"审批资料",visible:t.approvalDialogVisible,"before-close":t.closeApprovalDialog,width:"700px"}},[a("el-form",{staticClass:"demo-form-inline",attrs:{model:t.form,"label-width":"120px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"合同图片上传"}},[a("upload-pic",{ref:"upload",on:{getUrl:t.getUrl}})],1)],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.approvalDialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.approval}},[t._v("提交审批")])],1)],1),a("el-dialog",{staticClass:"user-dialog",attrs:{"close-on-click-modal":!1,title:"合同图片",visible:t.contractDialogVisible,"before-close":t.closeContractDialog,"append-to-body":"",width:"700px"}},[a("el-image",{staticClass:"stamp-pic",attrs:{src:t.contractPic}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.contractDialogVisible=!1}}},[t._v("确 定")])],1)],1)],1)])},l=[],i=(a("c5f6"),a("7f7f"),a("bd86")),o=a("365c"),n=a("2ef0"),r=a("6fc2"),c={name:"Contract",components:{UploadPic:r["a"]},data:function(){var t;return t={contractDialogVisible:!1,contractPic:"",operate:"detail",tableData:[],name:"",detailInfo:{},page:{no:1,total:0,size:20},searchForm:{contractEndTime:"",contractStartTime:"",endTime:"",memberName:"",startTime:"",status:""},form:{address:"",brand:"",brandPic:"",lat:"",lng:"",status:""},dialogVisible:!1,approvalDialogVisible:!1,selectRow:[],contractValid:[],contractTime:[],status:""},Object(i["a"])(t,"name",""),Object(i["a"])(t,"approvalPic",""),Object(i["a"])(t,"approvalId",""),Object(i["a"])(t,"statusOpt",[{value:"1",label:"受理中"},{value:"2",label:"受理中"},{value:"3",label:"保单确认，未启保"},{value:"4",label:"保单启保中"}]),t},created:function(){this.getData()},methods:{getUrl:function(t){this.approvalPic=t},approvalReady:function(t){var e=this;this.approvalId=t.id,this.approvalDialogVisible=!0,this.$nextTick((function(){e.$refs.upload.clearPic()}))},reback:function(){var t=this;this.$confirm("确认不同意当前合同？").then((function(e){var a=row.id,s={id:a};priceDetele(s).then((function(e){t.$message.success({message:"操作成功"}),t.getData()}))})).catch((function(t){}))},closeApprovalDialog:function(){this.approvalDialogVisible=!1},exportContract:function(t){var e=document.createElement("a");e.href="https://wuyoubao.sankinetwork.com/api/wyht/eportContract?id="+t.id,e.setAttribute("download",name),document.body.appendChild(e),e.click()},getStatus:function(t){for(var e=0;e<this.statusOpt.length;e++){var a=this.statusOpt[e];if(t==a.value)return a.label}},approval:function(){var t=this;if(""!=this.approvalPic){var e={id:this.approvalId,status:"2",pic:this.approvalPic};Object(o["f"])(e).then((function(e){t.$message.success({message:"提交审批成功"}),t.closeApprovalDialog(),t.getData()}))}else this.$message.warning({message:"请先上传合同图片"})},search:function(){this.getData()},handlePageChange:function(){this.getData()},getData:function(){var t=this,e={pageSize:this.page.size,page:this.page.no,contractEndTime:this.contractValid[1]||"",contractStartTime:this.contractValid[0]||"",memberName:this.name,startTime:this.contractTime[0]||"",endTime:this.contractTime[1]||"",status:this.status};Object(o["h"])(e).then((function(e){t.tableData=e.records,t.page.total=e.total,t.page.no=e.current}))},handleSelectionChange:function(t){this.selectRow=t},edit:function(t){this.operate="edit",t.status=Number(t.status),this.form=t,this.openDialog()},detail:function(t){var e=this;Object(o["g"])({id:t.id}).then((function(t){e.detailInfo=t,e.operate="detail",e.form=t,e.openDialog()}))},del:function(t){this.operate="edit",t.status=Number(t.status),this.form=t,this.form.status=0,this.save()},save:function(){var t=this,e=Object(n["cloneDeep"])(this.form);"edit"==this.operate&&(delete e.password,userUpdate(e).then((function(e){e&&(t.$message.success({message:"修改成功"}),t.dialogVisible=!1,t.getData())})))},showContract:function(t){this.contractDialogVisible=!0,this.contractPic=t.pic},closeContractDialog:function(){this.contractDialogVisible=!1},openDialog:function(){this.dialogVisible=!0},closeDialog:function(){this.dialogVisible=!1}}},u=c,f=(a("e038"),a("2877")),p=Object(f["a"])(u,s,l,!1,null,"271127d2",null);e["default"]=p.exports},"454f":function(t,e,a){a("46a7");var s=a("584a").Object;t.exports=function(t,e,a){return s.defineProperty(t,e,a)}},"46a7":function(t,e,a){var s=a("63b6");s(s.S+s.F*!a("8e60"),"Object",{defineProperty:a("d9f6").f})},"6fc2":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"crop-demo"},[a("div",{staticClass:"crop-demo-btn"},[t._v("选择图片\n            "),a("input",{staticClass:"crop-input",attrs:{type:"file",name:"image",accept:"image/*"},on:{change:t.setImage}})]),a("img",{directives:[{name:"show",rawName:"v-show",value:t.imgSrc,expression:"imgSrc"}],staticClass:"pre-img",attrs:{src:t.imgSrc}})])])},l=[],i=(a("6762"),a("2fdb"),a("7f7f"),a("f744")),o=a("365c"),n={name:"upload",data:function(){return{fileList:[],imgSrc:""}},components:{},methods:{clearPic:function(){this.fileList=[],this.imgSrc=""},setImage:function(t){var e=this;Object(o["K"])().then((function(a){var s=e,l=t.target.files[0],o=i["b"](l,l.name,a,{},{region:i["a"].z2}),n={next:function(t){},error:function(t){console.log(res)},complete:function(t){s.$message.success({message:"上传成功"});var e="http://storage.sankinetwork.com/"+t.key;s.$emit("getUrl",e)}};o.subscribe(n)}));var a=t.target.files[0];if(a.type.includes("image/")){var s=new FileReader;s.onload=function(t){e.imgSrc=t.target.result},s.readAsDataURL(a)}},imageuploaded:function(t){console.log(t)},handleError:function(){this.$notify.error({title:"上传失败",message:"图片上传接口上传失败，可更改为自己的服务器接口"})}},created:function(){this.clearPic()}},r=n,c=(a("a282"),a("2877")),u=Object(c["a"])(r,s,l,!1,null,"6bc7288a",null);e["a"]=u.exports},"85f2":function(t,e,a){t.exports=a("454f")},8880:function(t,e,a){},"9cca":function(t,e,a){},a282:function(t,e,a){"use strict";var s=a("9cca"),l=a.n(s);l.a},bd86:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var s=a("85f2"),l=a.n(s);function i(t,e,a){return e in t?l()(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},e038:function(t,e,a){"use strict";var s=a("8880"),l=a.n(s);l.a}}]);